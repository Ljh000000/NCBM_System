# 设备管理功能说明

## 功能概述

Web界面现在支持完整的设备管理功能，包括添加、编辑、删除设备，无需手动编辑配置文件。

## 功能特性

### ✅ 添加设备
- 点击"添加设备"按钮打开添加表单
- 填写设备信息（名称、IP、用户名、密码、设备类型）
- 自动保存到config.ini
- 实时更新设备列表

### ✅ 编辑设备
- 点击设备列表中的"编辑"按钮
- 修改设备信息（IP、用户名、密码、设备类型）
- 设备名称不可修改（作为唯一标识）
- 密码留空则保持原密码不变
- 自动保存配置

### ✅ 删除设备
- 点击设备列表中的"删除"按钮
- 确认删除操作
- 自动断开设备连接
- 删除设备配置（备份文件保留）

## 使用方法

### 添加设备

1. 点击设备列表右上角的"添加设备"按钮（绿色+号）
2. 填写设备信息：
   - **设备名称**：唯一标识（必填）
   - **IP地址**：设备IP地址（必填）
   - **用户名**：SSH登录用户名（必填）
   - **密码**：SSH登录密码（必填）
   - **设备类型**：选择设备类型（必填）
3. 点击"保存"按钮
4. 设备会自动添加到列表

### 编辑设备

1. 在设备列表中找到要编辑的设备
2. 点击设备右侧的"编辑"按钮（铅笔图标）
3. 修改需要更改的信息：
   - IP地址、用户名、设备类型可以直接修改
   - 密码：留空则保持原密码，输入新密码则更新
4. 点击"保存"按钮
5. 配置会自动更新

### 删除设备

1. 在设备列表中找到要删除的设备
2. 点击设备右侧的"删除"按钮（垃圾桶图标）
3. 确认删除操作
4. 设备配置会被删除（备份文件保留）

## API接口

### POST /api/devices
添加设备

**请求体**:
```json
{
  "name": "switch1",
  "ip": "192.168.1.1",
  "username": "admin",
  "password": "password123",
  "device_type": "cisco_ios"
}
```

### PUT /api/devices
更新设备

**请求体**:
```json
{
  "name": "switch1",
  "ip": "192.168.1.2",
  "username": "admin",
  "password": "newpassword",  // 可选，留空则保持原密码
  "device_type": "cisco_ios"
}
```

### DELETE /api/devices?device_name=switch1
删除设备

## 界面说明

### 设备列表显示

每个设备显示：
- 设备名称
- IP地址和设备类型
- 用户名
- 编辑按钮（铅笔图标）
- 删除按钮（垃圾桶图标）

### 设备管理模态框

包含以下字段：
- 设备名称（编辑时只读）
- IP地址
- 用户名
- 密码（编辑时可留空）
- 设备类型（下拉选择）

## 注意事项

1. **设备名称唯一性**：设备名称必须唯一，不能重复
2. **密码安全**：密码以明文存储在config.ini中，生产环境建议加密
3. **删除设备**：删除设备不会删除备份文件，备份文件会保留
4. **编辑密码**：编辑设备时，如果密码留空，原密码保持不变
5. **设备连接**：编辑或删除设备时，如果设备正在连接，会自动断开

## 支持的设备类型

- Cisco IOS
- Cisco IOS (Telnet)
- 华为
- H3C
- HP Comware
- Juniper
- Linux
- 其他

## 使用示例

### 示例1：添加新设备

```
1. 点击"添加设备"
2. 填写：
   名称: router2
   IP: 192.168.1.3
   用户名: admin
   密码: cisco123
   类型: cisco_ios
3. 点击"保存"
```

### 示例2：修改设备IP

```
1. 点击设备"router2"的编辑按钮
2. 修改IP地址为: 192.168.1.4
3. 密码留空（保持原密码）
4. 点击"保存"
```

### 示例3：删除设备

```
1. 点击设备"router2"的删除按钮
2. 确认删除
3. 设备从列表中移除
```

---

**功能状态**: ✅ 已实现  
**最后更新**: 2025-12-20

