# 测试指南

## 测试方式

### 方式1：Web界面测试（推荐）

#### 步骤：

1. **启动Flask应用**
```bash
python app.py
```

2. **打开浏览器**
访问：http://localhost:5000

3. **测试添加设备**
   - 点击"添加设备"按钮
   - 填写设备信息
   - 点击"保存"
   - ✅ 应该看到设备出现在列表中

4. **测试编辑设备**
   - 点击设备右侧的"编辑"按钮
   - 修改信息
   - 点击"保存"
   - ✅ 应该看到更新成功

5. **测试删除设备**
   - 点击设备右侧的"删除"按钮
   - 确认删除
   - ✅ 应该看到设备从列表消失

---

### 方式2：使用测试脚本（自动化）

#### 步骤：

1. **安装依赖**（如果需要）
```bash
pip install requests
```

2. **启动Flask应用**（终端1）
```bash
python app.py
```

3. **运行测试脚本**（终端2）
```bash
python test_device_management.py
```

测试脚本会自动测试：
- ✅ 配置文件操作
- ✅ API接口（添加、获取、更新、删除）

---

### 方式3：系统功能测试

#### 运行系统测试

```bash
python test_system.py
```

测试脚本会检查：
- 配置文件加载
- 备份管理功能
- 配置差异对比
- 设备管理模块
- 邮件通知模块

---

## 测试检查清单

### 功能测试

- [ ] **添加设备**
  - [ ] 模态框正常打开
  - [ ] 表单验证正常工作
  - [ ] 添加成功后设备出现在列表
  - [ ] config.ini文件已更新

- [ ] **编辑设备**
  - [ ] 点击编辑按钮，表单显示当前信息
  - [ ] 设备名称不可修改（只读）
  - [ ] 可以修改IP、用户名、设备类型
  - [ ] 密码留空时保持原密码
  - [ ] 编辑成功后信息已更新

- [ ] **删除设备**
  - [ ] 显示确认对话框
  - [ ] 删除成功后设备从列表消失
  - [ ] config.ini文件已更新
  - [ ] 备份文件保留（如果存在）

- [ ] **备份功能**
  - [ ] 手动备份成功
  - [ ] 备份文件正确保存
  - [ ] 备份历史正确显示

- [ ] **配置对比**
  - [ ] 可以对比两个备份文件
  - [ ] 差异显示正确

- [ ] **配置恢复**
  - [ ] 可以恢复配置到设备
  - [ ] 恢复过程正常完成

### 边界测试

- [ ] **添加重复名称的设备**：应该提示"设备名称已存在"
- [ ] **必填字段为空**：应该提示错误
- [ ] **编辑不存在的设备**：应该提示"设备不存在"
- [ ] **删除不存在的设备**：应该提示"设备不存在"

---

## 常见问题

### Q: 测试脚本显示"无法连接到服务器"

**A**: Flask应用未运行
```bash
# 启动Flask
python app.py
```

### Q: 添加设备时提示"设备名称已存在"

**A**: 该设备名称已被使用
- 使用不同的设备名称
- 或先删除已存在的设备

### Q: 编辑设备时密码问题

**A**: 
- 编辑时密码可以留空（保持原密码）
- 或输入新密码进行更新

---

## 成功标志

### Web界面测试成功标志

1. ✅ 添加设备后，设备出现在列表中
2. ✅ 编辑设备后，信息已更新
3. ✅ 删除设备后，设备从列表消失
4. ✅ 所有操作都有成功提示

### 测试脚本成功标志

```
配置文件操作: [OK] 通过
添加设备API: [OK] 通过
获取设备列表API: [OK] 通过
更新设备API: [OK] 通过
删除设备API: [OK] 通过

总计: 5 通过, 0 失败

[OK] 所有测试通过！
```

---

## 快速开始

**最简单的方式**：

1. 运行 `python app.py`
2. 打开浏览器访问 http://localhost:5000
3. 点击"添加设备"按钮开始测试

---

**提示**：测试完成后，记得清理测试数据（删除测试设备）

